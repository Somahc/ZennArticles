---
title: "åˆVJã«æŒ‘æˆ¦ã™ã‚‹ã«ã‚ãŸã‚Šã€Webã‚·ã‚§ãƒ¼ãƒ€ã‚¨ãƒ‡ã‚£ã‚¿ã‚’ä½œã£ã¦ã¿ãŸ"
emoji: "âœ¨"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["TypeScript", "WebGL", "React"]
published: false
---
[MYJLab Advent Calendar 2025](https://qiita.com/advent-calendar/2025/myjlab)ã®2æ—¥ç›®ã‚’æ‹…å½“ã—ã¾ã™ã€Sigreniã¨ç”³ã—ã¾ã™ã€‚ã›ã£ã‹ããªã®ã§å‹æ‰‹ãªãŒã‚‰[ã‚°ãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚¹å…¨èˆ¬ Advent Calendar 2025](https://qiita.com/advent-calendar/2025/graphics)ã¸ã‚‚ãƒãƒ«ãƒãƒã‚¹ãƒˆã—ã¾ã™ã€‚ã‚ˆã‚ã—ããŠé¡˜ã„ã—ã¾ã™ğŸ¤²

è»½ãè‡ªå·±ç´¹ä»‹ã™ã‚‹ã¨ã€æŠ€è¡“çš„ã«ã¯Webãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚’2å¹´ã¡ã‚‡ã£ã¨é½§ã£ã¦ã„ã‚‹ä¿®å£«ä¸€å¹´ç”Ÿã§ã™ã€‚ç ”ç©¶å®¤ã¨ã¯ã‚ã¾ã‚Šé–¢ä¿‚ã‚ã‚Šã¾ã›ã‚“ãŒã€ã“ã“ä¸€å¹´ç¨‹ã®ãƒã‚¤ãƒ–ãƒ¼ãƒ ãŒCGã§ã™ã€‚ãã‚“ãªä¸­ã€å…ˆæ—¥ã¯ã˜ã‚ã¦VJã‚’ã‚„ã‚‹æ©Ÿä¼šãŒã‚ã‚Šã€ã‚·ã‚§ãƒ¼ãƒ€ã‚’ä½¿ã£ãŸãƒ©ã‚¤ãƒ–ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã«æŒ‘æˆ¦ã—ã¾ã—ãŸã€‚ãã®éš›ã«Webã‚·ã‚§ãƒ¼ãƒ€ã‚¨ãƒ‡ã‚£ã‚¿ã‚’ä½œæˆã—ãŸã®ã§ã€ãã‚Œã«ã¤ã„ã¦ãŠè©±ã—ã§ãã‚Œã°ã¨æ€ã„ã¾ã™ã€‚

ï¼ˆä½œæˆã—ãŸã‚‚ã®ã¯ä»¥ä¸‹ã«ãªã‚Šã¾ã™â†“ ãœã²ã„ã˜ã£ã¦ã¿ã¦ãã ã•ã„ã€œï¼‰
https://somahc.github.io/glsl-livecoding-editor-web/
## å‰æçŸ¥è­˜ã‚„èƒŒæ™¯
ã„ããªã‚Šæ¨ªæ–‡å­—ã‚’ãŸãã•ã‚“å‡ºã—ã¦ã—ã¾ã„ã¾ã—ãŸãŒã€è¨€è‘‰ã«é¦´æŸ“ã¿ã®ãªã„æ–¹ã‚‚ã„ã‚‹ã¨æ€ã†ã®ã§ç°¡å˜ã«è£œè¶³ã—ã¾ã™ã€‚
### ã€ŒVJã€ã€Œã‚·ã‚§ãƒ¼ãƒ€ã€ã¨ã¯?
ã¾ãšã€VJã¨ã¯Visual Jockeyã‚„Video Jockeyã®ç•¥ã§ã™ã€‚ã‚¯ãƒ©ãƒ–ãªã©ã§éŸ³æ¥½ã‚’é¸æŠã—ã¦æµã™DJã¯ã”å­˜ã˜ã®æ–¹ãŒå¤šã„ã¨æ€ã„ã¾ã™ãŒã€ãã®æ˜ åƒç‰ˆã«ãªã‚Šã¾ã™ã€‚VJã¯éŸ³æ¥½ã«åˆã£ãŸæ˜ åƒã‚’æµã™ã“ã¨ã§å ´ã‚’è¦–è¦šçš„ã«ç››ã‚Šä¸Šã’ã¾ã™ã€‚
https://x.com/tktk_1/status/1977315624549487007?s=20

ã‚·ã‚§ãƒ¼ãƒ€(shader)ã¯ãƒ‡ã‚£ã‚¹ãƒ—ãƒ¬ã‚¤ä¸Šã«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒè¡¨ç¤ºã•ã‚Œã‚‹éš›ã€ãã®è¡¨ç¤ºã®ã•ã‚Œæ–¹ã‚’æ±ºã‚ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã«ãªã‚Šã¾ã™ã€‚ç¾å®Ÿã‚’æ¨¡ã—ãŸãƒªã‚¢ãƒ«ãªè³ªæ„Ÿã«ã—ãŸã‚Šã€ã‚¢ãƒ‹ãƒ¡èª¿ã«ãƒ‡ãƒ•ã‚©ãƒ«ãƒ¡ã—ãŸè³ªæ„Ÿã‚’å‡ºã—ãŸã‚Šãªã©ã€æ§˜ã€…ãªã“ã¨ãŒã§ãã¾ã™ã€‚Unityãªã©ã§ã‚²ãƒ¼ãƒ åˆ¶ä½œã®çµŒé¨“ãŒã‚ã‚‹æ–¹ã¯èã„ãŸã“ã¨ãŒã‚ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ã‚·ã‚§ãƒ¼ãƒ€è¨€èªã¨ã—ã¦æœ‰åãªã‚‚ã®ã«GLSL(OpenGL Shading Language)ãŒã‚ã‚Šã¾ã™ã€‚

åŸºæœ¬çš„ã«ã‚·ã‚§ãƒ¼ãƒ€å˜ä½“ã§ä½¿ã†ã“ã¨ã¯ãªã„ã®ã§ã™ãŒã€ãƒ¬ã‚¤ãƒãƒ¼ãƒãƒ³ã‚°ãªã©ã®ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã‚’ä½¿ã†ã“ã¨ã§ã€GLSLã‚’æ›¸ãã ã‘ã§é¢ç™½ã„çµµã‚’å‡ºã™ã“ã¨ãŒã§ãã¾ã™ï¼ˆè©³ç´°ã¯å‰²æ„›ã—ã¾ã™ï¼‰ã€‚ä¿—ã«â€ã‚·ã‚§ãƒ¼ãƒ€èŠ¸â€ã¨å‘¼ã°ã‚ŒãŸã‚Šã‚‚ã—ã¾ã™ã€‚
https://youtu.be/NX5vcd-ZY9s?si=q0PTH2bcHSzIfBUT&t=1160

ä»Šå›ã¯ã‚·ã‚§ãƒ¼ãƒ€ã‚’å®Ÿéš›ã«æ›¸ãã“ã¨ã§æ˜ åƒã‚’å¤‰åŒ–ã•ã›ã‚‹ã€ãƒ©ã‚¤ãƒ–ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¹ã‚¿ã‚¤ãƒ«ã§ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã—ã¦ã¿ã¾ã—ãŸã€‚

### ãªãœåˆ¶ä½œã—ãŸã®ï¼Ÿ
æ¦‚è¦ã¯ãµã‚“ã‚ã‚Šã‚ã‹ã£ã¦ã„ãŸã ã‘ãŸã¨æ€ã†ã®ã§ã™ãŒã€ãã‚‚ãã‚‚ã‚·ã‚§ãƒ¼ãƒ€ã‚¨ãƒ‡ã‚£ã‚¿ã‚’ä½œã‚‹å¿…è¦ãŒã‚ã‚‹ã®ã‹ã€ã¨ã„ã†è©±ãªã‚“ã§ã™ãŒ...ã€‚çµè«–ã‹ã‚‰è¨€ã£ã¦ã—ã¾ã†ã¨ã€ä½œã‚ŠãŸã‹ã£ãŸã‹ã‚‰ä½œã‚Šã¾ã—ãŸã€‚ï¼ˆç¬‘ï¼‰
ã‚‚ã†ã¡ã‚‡ã£ã¨çœŸé¢ç›®ã«è©±ã™ã¨ã€Three.jsã®ã‚ˆã†ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªãªã—ã§WebGLã‚’ç›´æ¥æ‰±ã£ãŸã“ã¨ãŒãªãã€å‹‰å¼·ã—ãŸã„ãªã¨æ€ã£ã¦ã„ãŸè‡ªåˆ†ã«ã¨ã£ã¦è‰¯ã„æ©Ÿä¼šã§ã—ãŸã€‚~~ã‚ã¨ã‚¨ãƒ‡ã‚£ã‚¿ã‹ã‚‰ä½œã‚Œã°ã‚·ã‚§ãƒ¼ãƒ€ãŒå¾®å¦™ã§ã‚‚è¨±ã—ã¦ã‚‚ã‚‰ãˆã‚‹ã¨æ€ã„ã¾ã—ãŸã€‚~~

å®Ÿéš›ã€[Bonzomatic](https://github.com/Gargaj/Bonzomatic)ã‚„[Sh4derJockey](https://github.com/slerpyyy/sh4der-jockey)ã¨ã„ã£ãŸãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã«ä½¿ãˆã‚‹ãƒ•ãƒªãƒ¼ã®ã‚·ã‚§ãƒ¼ãƒ€ã‚¨ãƒ‡ã‚£ã‚¿ã¯è‰²ã€…ã¨å­˜åœ¨ã—ã¾ã™ã€‚Webä¸Šã§ã‚·ã‚§ãƒ¼ãƒ€ã‚’ã‹ã‘ã‚‹ç’°å¢ƒã‚‚è‰²ã€…ã¨ã‚ã‚‹ã®ã§ã€èª¿ã¹ã¦ã¿ã¦ãã ã•ã„ã€‚

## åˆ¶ä½œã—ãŸã‚¨ãƒ‡ã‚£ã‚¿ã«ã¤ã„ã¦
åˆ¶ä½œã—ãŸã‚¨ãƒ‡ã‚£ã‚¿ã®æ¦‚è¦ã‚„æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯ã«ã¤ã„ã¦ç´¹ä»‹ã—ã¾ã™ã€‚ä½œã£ãŸã®ãŒ3ãƒ¶æœˆå‰ãªã®ã§ã‹ãªã‚Šå¿˜ã‚Œã¦ã‚‹ã¨ã“ã‚ã‚‚ã‚ã‚‹ã®ã§ã™ãŒã€æ€ã„å‡ºã—ãªãŒã‚‰æ›¸ãã¾ã™ã€‚

### æ¦‚è¦
![åˆ¶ä½œã—ãŸã‚¨ãƒ‡ã‚£ã‚¿ã®ç”»é¢](https://storage.googleapis.com/zenn-user-upload/ec9401c625d9-20251127.png)
æœ¬ç¨¿ã®å†’é ­ã«è²¼ã£ãŸãƒªãƒ³ã‚¯ã¸ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã“ã¨ã§ã€ä»Šå›åˆ¶ä½œã—ãŸã‚¨ãƒ‡ã‚£ã‚¿ã‚’è¦‹ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨ä¸Šã®ã‚ˆã†ãªç”»é¢ãŒç¾ã‚Œã‚‹ã¨æ€ã„ã¾ã™ã€‚

ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãæ›ãˆã¦Cmd+Sï¼ˆCtrl+Sï¼‰ã‚­ãƒ¼ã§ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ãŒæˆåŠŸã™ã‚‹ã¨èƒŒæ™¯ã®ã‚·ã‚§ãƒ¼ãƒ€ãƒ¼å®Ÿè¡ŒçµæœãŒæ›´æ–°ã•ã‚Œã¾ã™ã€‚
ã¾ãŸã€ç”»é¢ä¸‹ã®UIã‹ã‚‰BPMã¨ã„ã†å€¤ã‚’å¤‰æ›´ã™ã‚‹ã“ã¨ãŒã§ãã€ãã®å€¤ã¯bpmã¨ã„ã†uniformå¤‰æ•°ã¨ã—ã¦ã‚·ã‚§ãƒ¼ãƒ€ã«æ¸¡ã•ã‚Œã¾ã™ã€‚æ›²ã«åˆã‚ã›ã¦BPMã®å€¤ã‚’èª¿æ•´ã™ã‚‹ã“ã¨ã§ã€æ›²ã®ãƒ†ãƒ³ãƒã«åˆã£ãŸæ˜ åƒã‚’å‡ºã™ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚è©³ç´°ã¯GitHubãƒªãƒã‚¸ãƒˆãƒªã®READMEã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚ï¼ˆ[ãƒªãƒ³ã‚¯](https://github.com/Somahc/glsl-livecoding-editor-web)ï¼‰

## åˆ©ç”¨æŠ€è¡“
æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚

### ãƒ“ãƒ«ãƒ‰ãƒ„ãƒ¼ãƒ«
- Vite

### ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãƒ»ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãªã©
- React
- TypeScript
- react-codemirror
- jotai

ã‹ãªã‚Šã‚·ãƒ³ãƒ—ãƒ«ã ã¨æ€ã„ã¾ã™ã€‚è¦ä»¶ã¨ã—ã¦ã¯ãã“ã¾ã§å¤šããªãã€GLSLã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãã€èƒŒæ™¯ã§ãã®å®Ÿè¡ŒçµæœãŒå†ç”Ÿã•ã‚Œã‚Œã°æœ€ä½é™OKã ã£ãŸã®ã§ã€ã§ãã‚‹ã ã‘ã‚·ãƒ³ãƒ—ãƒ«ãªæ§‹æˆã«ã™ã‚‹ã“ã¨ã‚’ç›®æŒ‡ã—ã¾ã—ãŸã€‚
æŠ€è¡“é¸å®šã«ã¯ãã‚ŒãŒåæ˜ ã•ã‚Œã¦ã„ã‚‹ã¨æ€ã„ã¾ã™ã€‚SSRã¨ã‹ã¯ã—ãªãã¦ã„ã„ã®ã§Next.jsã¯ä½¿ã£ã¦ã„ãªã„ã—ã€ã‚³ãƒ¼ãƒ‰ã‚¨ãƒ‡ã‚£ã‚¿ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã¯Microsoftè£½ã®Monaco EditorãŒæœ‰åã§ã™ãŒã€ã‚ˆã‚Šè»½é‡ãªCodeMirrorã‚’æ¡ç”¨ã—ã¾ã—ãŸã€‚ã¾ãŸã€CodeMirrorã¯ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºãŒæŸ”è»Ÿã«ã§ãã‚‹ã¨ã„ã†ãƒ¡ãƒªãƒƒãƒˆã‚‚ã‚ã‚Šã¾ã—ãŸã€‚ï¼ˆMonaco Editorã¯ä½¿ã£ãŸã“ã¨ãªã„ã®ã§ã‚ã¾ã‚Šã‚ã‹ã‚Šã¾ã›ã‚“ãŒã€ã€ï¼‰

## å¤§å¤‰ã ã£ãŸ or ã“ã ã‚ã£ãŸã¨ã“ã‚
å®Ÿè£…ã¯ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³ã—ã¦ã‚‚ã‚‰ãˆã‚Œã°ã„ãã‚‰ã§ã‚‚è¦‹ã‚Œã‚‹ã®ã§ã™ãŒã€ã¡ã‚‡ã£ã¨å¤§å¤‰ã ã£ãŸã¨ã“ã‚ã‚„ã“ã ã‚ã‚Šãƒã‚¤ãƒ³ãƒˆã‚’ãƒ”ãƒƒã‚¯ã‚¢ãƒƒãƒ—ã—ã¦ç´¹ä»‹ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚

### WebGL
ã¾ã‚ã€äºˆæƒ³ã¯ã—ã¦ã¾ã—ãŸãŒã€WebGLã‚’ç”Ÿã§æ‰±ã†ã®ã¯ãªã‹ãªã‹éª¨ãŒæŠ˜ã‚Œã¾ã—ãŸã€‚WebGPUã‚ˆã‚Šæ¥½ã¨ã¯ã„ãˆã€ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã¯å¤§å¤‰ã§ã™ã€‚
WebGLã§ä½•ã‚‰ã‹ã®çµµã‚’å‡ºã™æµã‚Œã¯ã€ã–ã£ãã‚Šä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

1. webgl2ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã§canvasã‚’å–å¾—ã™ã‚‹
2. vertex shaderã¨fragment shaderã‚’ãã‚Œãã‚Œã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã™ã‚‹
3. vertex shaderã¨fragment shaderã‚’ã‚¢ã‚¿ãƒƒãƒãƒ»ãƒªãƒ³ã‚¯ã—ã¦ã‚·ã‚§ãƒ¼ãƒ€ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ä½œã‚Šã€`useProgram()`ã§ä½¿ç”¨ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’æŒ‡å®šã™ã‚‹
4. VBO(Vertex Buffer Object, é ‚ç‚¹ãƒãƒƒãƒ•ã‚¡)ã‚’ä½œæˆã—ã€é ‚ç‚¹åº§æ¨™ãƒ‡ãƒ¼ã‚¿ã‚’vertex shaderã®inå¤‰æ•°ã«ç´ã¥ã‘ã‚‹

ã‚ã¨ã¯`requestAnimationFrame()`ã§æ¯ãƒ•ãƒ¬ãƒ¼ãƒ ã®ãƒ«ãƒ¼ãƒ—å‡¦ç†ã‚’æ›¸ã„ã¦çµ‚ã‚ã‚Šã§ã™ã€‚å…·ä½“çš„ã«ã¯ã€ã‚·ã‚§ãƒ¼ãƒ€ã«æ¸¡ã™uniformå¤‰æ•°ã‚’ã‚»ãƒƒãƒˆã¨ã€ä¸‰è§’ãƒãƒªã‚´ãƒ³ã®æç”»å‘½ä»¤ã‚’æ›¸ã„ã¦ã‚ã’ã¾ã™ã€‚ä»Šå›ã¯uniformå¤‰æ•°ã¨ã—ã¦ç”»é¢è§£åƒåº¦ã‚’è¡¨ã™resolutionã¨çµŒéæ™‚é–“ã‚’è¡¨ã™timeã®ã»ã‹ã«ã€ã‚¢ãƒ—ãƒªã®UIã‹ã‚‰å…¥åŠ›ã•ã‚Œã‚‹bpmã‚’ç”¨æ„ã—ã¦ã„ã¾ã™ã€‚
:::details WebGLã®å­¦ç¿’ã«ã¤ã„ã¦
æ­£ç›´ã“ã“ã¾ã§ã®å†…å®¹ã¯WebGLã‹OpenGLã®çµŒé¨“ãŒç„¡ã„ã¨è¬ã®å˜èªã®ç¾…åˆ—ã«ã—ã‹è¦‹ãˆãªã„ã¨æ€ã„ã¾ã™ã€‚ç§ã‚‚å­¦ç¿’ä¸­ã§å‰ãã†ãªã“ã¨ã¯è¨€ãˆã¾ã›ã‚“ãŒã€wgld.orgã¨ã„ã†ã‚µã‚¤ãƒˆã§3Dæç”»ã®åŸºç¤ã‹ã‚‰ã€WebGLã§ã®å®Ÿè£…ãªã©ã«ã¤ã„ã¦ã‚ã‹ã‚Šã‚„ã™ãè§£èª¬ã•ã‚Œã¦ã„ã‚‹ã®ã§ã€èˆˆå‘³ã®ã‚ã‚‹æ–¹ã¯è¦—ã„ã¦ã¿ã‚‹ã¨é¢ç™½ã„ã¨æ€ã„ã¾ã™ã€‚
https://wgld.org/sitemap.html
:::

#### ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ãƒˆãƒ©ã‚¤ã‚¢ãƒ³ã‚°ãƒ«
canvasã®ç”»é¢ã„ã£ã±ã„ã«fragment shaderã®å®Ÿè¡ŒçµæœãŒåºƒãŒã£ã¦ãã‚Œã‚Œã°ã‚ˆã‹ã£ãŸã‚ã‘ã§ã™ãŒã€ãã‚Œã‚’å®Ÿè£…ã™ã‚‹ãŸã‚ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ãƒˆãƒ©ã‚¤ã‚¢ãƒ³ã‚°ãƒ«ã¨ã„ã†ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ï¼Ÿã‚’ChatGPTã‹ã‚‰æ•™ãˆã¦ã‚‚ã‚‰ã„ã€å®Ÿè£…ã—ã¾ã—ãŸã€‚åº§æ¨™ç©ºé–“ã¯(-1,-1)~(1,1)ã ãã†ãªã‚“ã§ã™ãŒã€è¦ã¯ãã‚Œã‚’ã™ã¹ã¦è¦†ã†ãƒãƒªã‚´ãƒ³ãŒã‚ã‚Œã°è‰¯ã„ã‚ã‘ã§ã™ã€‚ãã“ã§(-1,-1), (3,-1), (-1,3)ã‚’é ‚ç‚¹ã¨ã™ã‚‹ãƒãƒªã‚´ãƒ³ã‚’æç”»ã™ã‚‹ã‚ˆã†ã«vertex shaderã«æŒ‡ç¤ºã—ã¦ã„ã¾ã™ã€‚
ä½œæˆã—ãŸã‚¨ãƒ‡ã‚£ã‚¿ã§ç·¨é›†ã™ã‚‹ã®ã¯fragment shaderã®ã¿ã§ã‚ã‚‹ãŸã‚ã€ã“ã®å‡¦ç†ã‚„vertex shaderã®ã‚³ãƒ¼ãƒ‰è‡ªä½“ã«ã¤ã„ã¦ã¯ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ã—ã¦ã‚ã‚Šã¾ã™ã€‚
```ts:ShaderCanvas.tsx
...

const vs = `#version 300 es
      layout(location=0) in vec2 pos;       // â† å›ºå®šãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã€æ¿ãƒãƒªãªã®ã§Zã¯0ã§å›ºå®šã™ã‚‹ã‹ã‚‰äºŒæ¬¡å…ƒ
      void main(){ gl_Position = vec4(pos, 0.0, 1.0); }`;

...

// ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ãƒˆãƒ©ã‚¤ã‚¢ãƒ³ã‚°ãƒ«ã®é ‚ç‚¹ä½ç½®
const vertexPosition = new Float32Array([-1, -1, 3, -1, -1, 3]);

// VBO(Vertex Buffer Object, é ‚ç‚¹ãƒãƒƒãƒ•ã‚¡)ã‚’ä½œæˆã—ã€é ‚ç‚¹åº§æ¨™ãƒ‡ãƒ¼ã‚¿ã‚’vertex shaderã®inå¤‰æ•°ã«ç´ã¥ã‘ã‚‹
const vbo = glCreateBuffer(gl, vertexPosition);
gl.bindBuffer(gl.ARRAY_BUFFER, vbo);
gl.vertexAttribPointer(0, attStride, gl.FLOAT, false, 0, 0);
gl.enableVertexAttribArray(0);

...
```

#### canvasè¦ç´ ã®ç®¡ç†
æœ€åˆã¯ç´ ç›´ã«canvasã®refã‚’useRefã§ç®¡ç†ã—ã¦webgl2ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã®å–å¾—å‡¦ç†ã¨ã‹ã‚’æ›¸ã„ã¦ã„ãŸã®ã§ã™ãŒã€Reactã®StrictModeã«ãŠã„ã¦canvasãŒè¡¨ç¤ºã•ã‚Œã‚‹ã¹ãã¨ã“ã‚ã§å››è§’ã„æ‚²ã—ã’ãªé¡”ã‚¢ã‚¤ã‚³ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã¦ã—ã¾ã£ã¦ã„ã¾ã—ãŸã€‚ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠã‚’ç™»éŒ²ã—ã¦ã‚¨ãƒ©ãƒ¼ã‚’å‡ºåŠ›ã•ã›ã¦ã¿ã‚‹ã¨ã€webglcontextlostãŒç™ºç”Ÿã—ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã—ãŸã€‚
0b5vræ°åˆ¶ä½œã®wavenerdã®å®Ÿè£…ã§ä½¿ã‚ã‚Œã¦ã„ãŸuseElementã¨ã„ã†hooksã‚’ã»ã¼ãã®ã¾ã¾ä½¿ã£ã¦canvasã‚’å–å¾—ã—ã€WebGLã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆå–å¾—ã‚’è¡Œã†useEffectã®ä¾å­˜é…åˆ—ã«å«ã‚ã‚‹ã“ã¨ã§è§£æ±ºã—ã¾ã—ãŸã€‚
https://github.com/0b5vr/wavenerd/blob/dev/src/view/utils/useElement.ts

`useLayoutEffect`ã¯ã“ã“ã§åˆã‚ã¦çŸ¥ã‚Šã¾ã—ãŸã€‚ä½¿ã„ã‹ãŸã¯`useEffect`ã¨åŒã˜ã§ã€`useLayoutEffect(setup, dependencies?)`ã®ã‚ˆã†ã«ä½¿ã„ã¾ã™ã€‚é•ã„ã¯ã€DOMã®å¤‰æ›´ãŒåæ˜ ã•ã‚ŒãŸã‚ã¨ã€ãƒ–ãƒ©ã‚¦ã‚¶ãŒç”»é¢ã‚’æç”»ã™ã‚‹å‰ã«åŒæœŸçš„ã«å®Ÿè¡Œã•ã‚Œã‚‹ç‚¹ã¿ãŸã„ã§ã™ã€‚StrictModeã§è¡Œã‚ã‚Œã‚‹åˆæœŸåŒ–â†’ç›´å¾Œã«å¼·åˆ¶ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—â†’å†åˆæœŸåŒ–ã®å‡¦ç†ã§ã€`canvas.getContext("webgl2")`ã®ã‚ˆã†ãªãƒã‚¤ãƒ†ã‚£ãƒ–ãƒªã‚½ãƒ¼ã‚¹ã®ç¢ºä¿ã‚’ä¼´ã†å‡¦ç†ã¯å£Šã‚Œã‚„ã™ã„ã¿ãŸã„ã§ã™ã€‚useElementã§canvasãŒstateã¨ã—ã¦ç¢ºå®Ÿã«ã‚»ãƒƒãƒˆã•ã‚ŒãŸå¾Œã§useEffectãŒå®Ÿè¡Œã•ã‚Œã‚‹ã“ã¨ã§ã€åŠç«¯ãªã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ã®åˆæœŸåŒ–ã¨ç ´æ£„ã‚’é˜²ãã“ã¨ãŒã§ãã€è§£æ±ºã—ãŸã€ã€ã€ã¨ã„ã†ç†è§£ã§ã™ã€‚æ­£ç›´StrictModeã®æŒ™å‹•ã‚’ã—ã£ã‹ã‚Šç†è§£ã—ã¦ã„ãªã„ã®ã§ã¡ã‚‡ã£ã¨æ›–æ˜§ã§ã™ãŒã€ã¾ã‚ç›´ã£ãŸã®ã§ã‚¹ãƒ«ãƒ¼ã—ã¡ã‚ƒã„ã¾ã—ãŸã€‚
https://ja.react.dev/reference/react/useLayoutEffect

#### ã‚·ã‚§ãƒ¼ãƒ€ã®ãƒ›ãƒƒãƒˆã‚¹ãƒ¯ãƒƒãƒ—
ãƒ©ã‚¤ãƒ–ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’æƒ³å®šã—ã¦ã„ãŸã®ã§ã€ã‚·ã‚§ãƒ¼ãƒ€ã‚’æ›¸ãæ›ãˆã¦ãƒ›ãƒƒãƒˆã‚­ãƒ¼ã‚’æŠ¼ã™ã“ã¨ã§èƒŒæ™¯ã®å®Ÿè¡ŒçµæœãŒå³åº§ã«ç½®ãæ›ã‚ã‚‹ä»•æ§˜ã«ã—ã¦ã„ã¾ã™ã€‚å¤§äº‹ãªã®ã¯ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã®é€šã‚‰ãªã„ã‚·ã‚§ãƒ¼ãƒ€ã‚’æ›¸ã„ãŸéš›ã«æ˜ åƒã‚’é€”åˆ‡ã‚Œã•ã›ãªã„ã“ã¨ã§ã™ã€‚å®Ÿè£…ã¨ã—ã¦ã¯ã‚·ã‚§ãƒ¼ãƒ€ã‚³ãƒ¼ãƒ‰ã‚’æ¸¡ã™ã¨ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã¦ã‚·ã‚§ãƒ¼ãƒ€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œã£ã¦ãã‚Œã‚‹`glCreateShader()`ã‚’ä½œã£ã¦ãŠãã¾ã™ã€‚ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«å¤±æ•—æ™‚ã¯ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’Errorã¨ã—ã¦throwã—ã€å‘¼ã³å‡ºã—å…ƒã§catchã™ã‚‹ã‚ˆã†ã«ã—ã¦ã€ã‚·ã‚§ãƒ¼ãƒ€ã®ã‚¹ãƒ¯ãƒƒãƒ—ãŒå®Ÿè¡Œã•ã‚Œãªã„ã‚ˆã†ã«ã—ã¾ã™ã€‚catchç¯€ã§ã¯jotaiã§ç®¡ç†ã—ã¦ã„ã‚‹`compileErrorMessageAtom`ã«ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼æ–‡ã‚’ã‚»ãƒƒãƒˆã™ã‚‹ã“ã¨ã§ã€ã‚¢ãƒ—ãƒªUIã®ã‚¨ãƒ©ãƒ¼éƒ¨ã«ã‚¨ãƒ©ãƒ¼å†…å®¹ã‚’è¡¨ç¤ºã•ã›ã¦ã„ã¾ã™ã€‚

```ts:glCreateShader.ts
export function glCreateShader(
  gl: WebGLRenderingContext,
  type: "vertex" | "fragment",
  source: string
): WebGLShader | null {
  const shader = gl.createShader(
    type === "vertex" ? gl.VERTEX_SHADER : gl.FRAGMENT_SHADER
  )!;
  gl.shaderSource(shader, source);
  gl.compileShader(shader);

  if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {
    const rawLog = gl.getShaderInfoLog(shader) ?? "";

    // ç‰¹æ®Šæ–‡å­—ã‚’å‰Šé™¤
    const cleanedLog = (() => {
      let end = rawLog.length;
      while (end > 0) {
        const codePoint = rawLog.charCodeAt(end - 1);
        const isAsciiControl = codePoint === 0x7f || codePoint <= 0x1f; // DEL or C0 controls
        if (isAsciiControl) {
          end -= 1;
          continue;
        }
        break;
      }
      return rawLog.slice(0, end).trim();
    })();

    console.error(cleanedLog || undefined);
    throw new Error(cleanedLog || undefined);
  }

  return shader;
}
```

```ts:ShaderCanvas.tsx
...
const setCompileErrorMessage = useSetAtom(compileErrorMessageAtom);
...

// ã‚·ã‚§ãƒ¼ãƒ€ãƒ¼ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼è¡¨ç¤ºã€ãƒ›ãƒƒãƒˆã‚¹ãƒ¯ãƒƒãƒ—
  useEffect(() => {
    if (fsSource == null) return;
    const gl = glRef.current;
    const vsObj = glVertexShaderRef.current;
    if (!gl || !vsObj) return;

    try {
      const fsObj = glCreateShader(gl, "fragment", fsSource);
      if (fsObj == null) return;

      const newProg = glCreateProgram(gl, vsObj, fsObj);
      gl.useProgram(newProg);
      const newLocResolution = gl.getUniformLocation(newProg, "resolution");
      const newLocTime = gl.getUniformLocation(newProg, "time");
      const newLocBPM = gl.getUniformLocation(newProg, "bpm");
      // ã‚¹ãƒ¯ãƒƒãƒ—
      if (progRef.current) gl.deleteProgram(progRef.current);
      progRef.current = newProg;
      locResolutionRef.current = newLocResolution;
      locTimeRef.current = newLocTime;
      locBPMRef.current = newLocBPM;
      setCompileErrorMessage("");
    } catch (e) {
      if (e instanceof Error) {
        setCompileErrorMessage(e.message);
      } else if (typeof e === "string") {
        setCompileErrorMessage(e);
      } else {
        setCompileErrorMessage(JSON.stringify(e, null, 2));
      }
    }
  }, [fsSource, setCompileErrorMessage]);
...
```

### UIã«ã¤ã„ã¦
ã‚¢ãƒ—ãƒªã®UIã¯ã€Bonzomaticã‚’æ„è­˜ã—ã¤ã¤ã€ã‚ãˆã¦ãƒ¬ãƒˆãƒ­ãªæ„Ÿã˜ã‚’ç›®æŒ‡ã—ã¾ã—ãŸã€‚ãƒ•ãƒ¥ãƒ¼ãƒãƒ£ãƒ¼ãƒ¬ãƒˆãƒ­ã£ã¦ã„ã†ã‚“ã§ã—ã‚‡ã†ã‹ã€‚ãƒ€ã‚µã‹ã£ã“ã„ã„çš„ãªã€‚æ˜ ç”»ã€ŒALIENã€ã®ã‚ˆã†ãªé›°å›²æ°—ã§ã™ã€‚
https://pin.it/1tsSH0Cug
https://pin.it/5zbbhotvx

UIã¯æ–‡å­—ã‚„èƒŒæ™¯ãŒè‹¥å¹²å…‰ã£ã¦ã„ã‚‹ã‚ˆã†ãªè¦‹ãŸç›®ã‚’CSSã®text-shadowã‚„box-shadowã§å®Ÿç¾ã—ã€ç”»é¢ã«æ˜ ã£ã¦ã„ã‚‹æ„Ÿã‚’æ¼”å‡ºã—ã¦ã„ã¾ã™ã€‚
```css:ErrorPanel/index.module.css
.errorMessage {
  font-family: "Sometype Mono", monospace;
  color: white;
  padding: 0 5px;
  text-shadow: 0 0 2.5px var(--color-error), 0 0 5px var(--color-error),
    0 0 10px var(--color-error);

  width: fit-content;
  font-size: 14px;
  font-weight: 400;
  line-height: 1.5;
}
...
```
![](https://storage.googleapis.com/zenn-user-upload/f6896740e28e-20251201.png)

BEATã®éƒ¨åˆ†ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã®ä»•çµ„ã¿ã¯ã¡ã‚‡ã†ã©ä¸€å¹´å‰ã®ä»Šæ—¥ã«ã‚¢ãƒ‰ãƒ™ãƒ³ãƒˆã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã§ç´¹ä»‹ã—ãŸCSSã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã®å†…å®¹ã¨ã»ã¼åŒã˜ã§ã™ï¼beatæƒ…å ±ã‚’jotaiã§ç®¡ç†ã—ã€ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã§`translateX()`ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã§BEATã‚’ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã•ã›ã¦ã„ã¾ã™ã€‚
https://zenn.dev/somahc/articles/c0b81dfb270e2a
```ts:StatsPanel.tsx
...
const beatMeter = () => {
    const elapsedTime = currentElapsedTime * (shaderBPM / 60);
    const bar = Math.floor(elapsedTime);
    const beat = elapsedTime - bar;
    return 100 - beat * 100;
};

...

<div
    className={style.beatMeterBar}
    style={{ transform: `translateX(-${beatMeter()}%)` }}
></div>
...
```
https://gyazo.com/6065168aed751f8e598699e96815ac62
#### ã‚¨ãƒ‡ã‚£ã‚¿ã®ã‚¹ã‚¿ã‚¤ãƒ«
syntax highlight, ã‚³ãƒ¼ãƒ‰æ–‡å­—èƒŒæ™¯ã ã‘ã®é»’åŠé€æ˜èƒŒæ™¯ã¯codemirrorã®extensionã¨ã—ã¦å®Ÿè£…