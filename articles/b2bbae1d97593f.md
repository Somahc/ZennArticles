---
title: "Next.js App Routerã§ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆã‚’å®Ÿè£…ã™ã‚‹"
emoji: "ğŸŒ—"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [Nextjs, TailwindCSS, TypeScript]
published: true
---
Next.jsã§ã®ãƒ©ã‚¤ãƒˆãƒ»ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆã«ã¤ã„ã¦ã¯çµæ§‹æ—¥æœ¬èªè¨˜äº‹ã‚‚å¤šã‹ã£ãŸã®ã§ã™ãŒã€è‹±èªåª’ä½“ã§ã‚ã‹ã‚Šã‚„ã™ã„ã‚„ã¤ã‚’è¦‹ã¤ã‘ãŸ & App Routerã§ã®ã‚„ã‚Šæ–¹ã®è¨˜äº‹ãŒè‹¥å¹²å°‘ãªã„ï¼Ÿã€€ã¨æ€ã£ãŸã®ã§ã€ç°¡å˜ã«ã¾ã¨ã‚ãŸã„ã¨æ€ã„ã¾ã™ã€‚ã“ã®è¨˜äº‹ã§ã¯ã€
- ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ãƒ¦ãƒ¼ã‚¶ã®OSã§è¨­å®šã—ã¦ã‚ã‚‹ãƒ¢ãƒ¼ãƒ‰ã‚’é¸æŠ
- ãƒ©ã‚¤ãƒˆãƒ»ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã®æ‰‹å‹•åˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³

ã‚’å®Ÿè£…ã—ã¾ã™ã€‚

ä¸€éƒ¨ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãæ›ãˆã¦ã„ã¾ã™ãŒã€ã“ã®è¨˜äº‹ã¯åŸºæœ¬çš„ã«ä»¥ä¸‹ã®å‹•ç”»ã®å†…å®¹ã‚’ãªãã‚‹ã ã‘ã§ã™ã®ã§ã€å‹•ç”»ãŒã„ã„ã¨ã„ã†æ–¹ã¯ä»¥ä¸‹ã‚’ã”è¦§ãã ã•ã„ã€‚
https://www.youtube.com/watch?v=7zqI4qMDdg8


ä¸Šã®å‹•ç”»ã®è¨˜äº‹ç‰ˆï¼ˆè‹±èªï¼‰
https://www.davegray.codes/posts/light-dark-mode-nextjs-app-router-tailwind

## ç’°å¢ƒ
Next.js(App Router) 14.1.0
Tailwind CSS 3.4.1

## å®Ÿè£…
### tailwind.config.tsã®ç·¨é›†
tailwind.config.tsã«`darkMode: 'class',`ã¨ã„ã†ä¸€æ–‡ã‚’è¿½åŠ ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Š`dark:`ã¨ã„ã†ã‚¯ãƒ©ã‚¹ãŒæŒ‡å®šã•ã‚Œã¦ã„ã‚‹è¦ç´ ã¸ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ãŒé©ç”¨ã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚
```diff ts:tailwind.config.ts
import type { Config } from "tailwindcss";

const config: Config = {
  content: [
    "./src/pages/**/*.{js,ts,jsx,tsx,mdx}",
    "./src/components/**/*.{js,ts,jsx,tsx,mdx}",
    "./src/app/**/*.{js,ts,jsx,tsx,mdx}",
  ],
  theme: {
    extend: {
      backgroundImage: {
        "gradient-radial": "radial-gradient(var(--tw-gradient-stops))",
        "gradient-conic":
          "conic-gradient(from 180deg at 50% 50%, var(--tw-gradient-stops))",
      },
      colors: {
        "accent-1": "#FAFAFA",
        "accent-2": "#EAEAEA",
        "accent-7": "#333",
        success: "#0070f3",
        cyan: "#79FFE1",
      },
      spacing: {
        28: "7rem",
      },
      letterSpacing: {
        tighter: "-.04em",
      },
      fontSize: {
        "5xl": "2.5rem",
        "6xl": "2.75rem",
        "7xl": "4.5rem",
        "8xl": "6.25rem",
      },
      boxShadow: {
        sm: "0 5px 10px rgba(0, 0, 0, 0.12)",
        md: "0 8px 30px rgba(0, 0, 0, 0.12)",
      },
    },
  },
  plugins: [],
+ darkMode: 'class',
};
export default config;
```

### next-themes
next-themesãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«è¿½åŠ ã—ã¾ã™ã€‚ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§å®Ÿè¡Œã—ã¾ã™ã€‚
```
npm install next-themes
```

æ¬¡ã«appãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã«`providers.tsx`ã‚’ä½œæˆã—ã¾ã™ã€‚
ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’è²¼ã‚Šä»˜ã‘ã¾ã™ã€‚
```ts:providers.tsx
'use client'

import { ThemeProvider } from 'next-themes'

export function Providers({ children }: { children: React.ReactNode }) {
    return <ThemeProvider attribute="class" defaultTheme='system' enableSystem>{children}</ThemeProvider>
}
```
`<ThemeProvider attribute="class" defaultTheme='system' enableSystem>`ã«ã‚ˆã‚Šãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ãƒ†ãƒ¼ãƒã¨ã—ã¦ãƒ¦ãƒ¼ã‚¶ã®OSã®ãƒ†ãƒ¼ãƒãŒè‡ªå‹•çš„ã«é¸ã°ã‚Œã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ã€‚ã¾ãŸã€TailwindCSSã®ã‚¯ãƒ©ã‚¹åã§ãƒ©ã‚¤ãƒˆãƒ»ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã‚’åˆ¤å®šã™ã‚‹ãŸã‚ã«`attribute="class"`ã®è¨˜è¿°ãŒã‚ã‚Šã¾ã™ã€‚

æ¬¡ã«ã€`<Providers>`ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ãƒ«ãƒ¼ãƒˆã®layout.tsxï¼ˆ`app/layout.tsx`ï¼‰ã«è¿½åŠ ã—ã¾ã™ã€‚**ã“ã®æ™‚ã€`<body>`ã‚¿ã‚°ã®å†…å´ã«é…ç½®ã™ã‚‹ã“ã¨**ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚

```diff ts:app/layout.tsx
+ import { Providers } from './providers'

export default function RootLayout({
  children,
}: {
  children: React.ReactNode
}) {
  return (
    <html lang="ja" suppressHydrationWarning>
      <body>
+        <Providers>
            {children}
+        </Providers>
      </body>
    </html>
  )
}
```

:::details suppressHydrationWarningã«ã¤ã„ã¦
ã‚µã‚¤ãƒˆã‚’è¨ªã‚Œã‚‹ãƒ¦ãƒ¼ã‚¶ã®OSã®è¨­å®šï¼ˆãƒ©ã‚¤ãƒˆã‹ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã‹ï¼‰ã«ã‚ˆã£ã¦ã‚µã‚¤ãƒˆã®è¡¨ç¤ºã®ä»•æ–¹ã‚’å¤‰æ›´ã—ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ãŒã€ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã®Next.jsã«ã¯ãƒ¦ãƒ¼ã‚¶ã®OSã®è¨­å®šãŒä½•ã‹ã‚’çŸ¥ã‚‹è¡“ã¯ãªã„ã®ã§ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§next-themesãŒã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰é€ã‚‰ã‚Œã¦ããŸãƒ‡ãƒ¼ã‚¿ã‚’å¤‰æ›´ã—ã¦ãƒ†ãƒ¼ãƒã‚«ãƒ©ãƒ¼ã‚’é©ç”¨ã•ã›ã¾ã™ã€‚ã“ã®æ™‚ã€ã‚µãƒ¼ãƒã‹ã‚‰é€ã‚‰ã‚Œã¦ããŸæƒ…å ±ã¨ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®æƒ…å ±ãŒä¸€è‡´ã—ãªã„ã“ã¨ã§å‡ºã•ã‚Œã‚‹ã‚¨ãƒ©ãƒ¼ã‚’`supressHydrationWarning`ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã§æŠ‘åˆ¶ã—ã¦ã„ã¾ã™ã€‚
:::

### ãƒ†ãƒ¼ãƒã®æ‰‹å‹•åˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³
æœ€å¾Œã«ãƒ†ãƒ¼ãƒã®æ‰‹å‹•åˆ‡ã‚Šæ›¿ãˆã®ãŸã‚ã®ãƒœã‚¿ãƒ³ã‚’å®Ÿè£…ã—ã¾ã™ã€‚ã¾ãšã¯ã‚¢ã‚¤ã‚³ãƒ³ã®ãŸã‚ã®React Iconsã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚
```
npm install react-icons --save
```

æ¬¡ã«ã€é©å½“ãªå ´æ‰€ã«åˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚å‚è€ƒã‚µã‚¤ãƒˆã§ã¯`app/components`ã«`ThemeSwitch.tsx`ã¨ã„ã†åå‰ã§ä½œæˆã—ã¦ã„ã¾ã—ãŸã€‚
```ts:ThemeSwitch.tsx
'use client'

import { FiSun, FiMoon } from "react-icons/fi"
import { useState, useEffect } from 'react'
import { useTheme } from 'next-themes'

export default function ThemeSwitch() {
  const [mounted, setMounted] = useState(false)
  const { setTheme, resolvedTheme } = useTheme()

  useEffect(() =>  setMounted(true), [])

  if (!mounted) {
    return null;
  }

  if (resolvedTheme === 'dark') {
    return <FiSun size={30} onClick={() => setTheme('light')} />
  }

  if (resolvedTheme === 'light') {
    return <FiMoon size={30} onClick={() => setTheme('dark')} />
  }
}
```
ä¸Šè¿°ã—ãŸã‚ˆã†ã«ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã§ã¯ãƒ¦ãƒ¼ã‚¶ã®OSã®è¨­å®šãŒãƒ©ã‚¤ãƒˆãƒ»ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã©ã¡ã‚‰ãªã®ã‹åˆ¤å®šã§ããªã„ãŸã‚ã€ãƒã‚¦ãƒ³ãƒˆãŒçµ‚ã‚ã£ã¦ã‹ã‚‰ï¼ˆï¼ãƒ¦ãƒ¼ã‚¶ã®OSã®ãƒ¢ãƒ¼ãƒ‰ãŒåˆ¤æ˜ã—ã¦ã‹ã‚‰ï¼‰ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰ã§ãƒ†ãƒ¼ãƒã®åˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³ã‚’ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã™ã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚

ã¡ãªã¿ã«ã€`size={30}`ã®ã¨ã“ã‚ã®æ•°å­—ã‚’å¤‰ãˆã‚‹ã“ã¨ã§ã‚¢ã‚¤ã‚³ãƒ³ã®ã‚µã‚¤ã‚ºã‚’å¤‰ãˆã‚‰ã‚Œã‚‹ã®ã§ã€é©å®œå¤‰æ›´ã—ã¦ã‚ã’ã¦ãã ã•ã„ã€‚

### ãƒœã‚¿ãƒ³ã‚’é…ç½®ã—ã¦çµ‚ã‚ã‚Š
å…ˆã»ã©ä½œã£ãŸåˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’å¥½ããªå ´æ‰€ã«æŒ¿å…¥ã—ã¦å®Œæˆã§ã™ã€‚ç§ã¯layout.tsxã®ãƒ˜ãƒƒãƒ€ãƒ¼éƒ¨åˆ†ã«è¿½åŠ ã—ã¾ã—ãŸã€‚
```diff ts:app/layout.tsx
// (ä¸­ç•¥)
import { Providers } from "@/app/_components/providers";
+import ThemeSwitch from "@/app/_components/ThemeSwitch";

export default function RootLayout({
  children,
}: Readonly<{
  children: React.ReactNode;
}>) {
  return (
    <html lang="ja" suppressHydrationWarning>
      // ï¼ˆä¸­ç•¥ï¼‰
        <header className="text-gray-600 body-font">
            <div className="container mx-auto flex flex-wrap py-5 flex-col md:flex-row items-center">
            <Link href="/" className="flex title-font font-medium items-center text-gray-900 mb-4 md:mb-0">
                <span className="dark:text-white text-xl">Somahc</span>
            </Link>
            <nav className="md:mr-auto md:ml-4 md:py-1 md:pl-4 md:border-l md:border-gray-400	flex flex-wrap items-center text-base justify-center">
                <Link href="/about" className="mr-5 hover:text-gray-300">About</Link>
                <Link href="/blog" className="mr-5 hover:text-gray-300">Blog</Link>
            </nav>
+           <ThemeSwitch />
            </div>
        </header>
```

ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰æ™‚ã¯æœˆãƒœã‚¿ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã¦ã€æŠ¼ã™ã¨ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã«åˆ‡ã‚Šæ›¿ã‚ã‚‹ã¨åŒæ™‚ã«å¤ªé™½ãƒœã‚¿ãƒ³ã«å¤‰åŒ–ã—ã¾ã™ã€‚ç„¡äº‹å®Ÿè£…ã§ãã¾ã—ãŸã€‚
![](https://storage.googleapis.com/zenn-user-upload/134e7c24c43f-20240323.png)
![](https://storage.googleapis.com/zenn-user-upload/179802f3ca56-20240323.png)

## ãŠã‚ã‚Šã«
åˆã‚ã¦ãƒ©ã‚¤ãƒˆãƒ»ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆæ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¦ã¿ã¾ã—ãŸã€‚æœ€è¿‘ã¯ã„ã‚ã‚“ãªãƒšãƒ¼ã‚¸ã«å½“ãŸã‚Šå‰ã®ã‚ˆã†ã«å®Ÿè£…ã•ã‚Œã¦ã„ã‚‹æ©Ÿèƒ½ã§ã™ãŒã€è‡ªåˆ†ã§å®Ÿè£…ã§ãã‚‹ã¨ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ä¸ŠãŒã‚Šã¾ã™ã­ã€‚

## å‚è€ƒ
https://www.youtube.com/watch?v=7zqI4qMDdg8
https://www.davegray.codes/posts/light-dark-mode-nextjs-app-router-tailwind
https://goodpatch-tech.hatenablog.com/entry/next-themes-tailwind
https://zenn.dev/taichifukumoto/articles/how-to-use-react-icons